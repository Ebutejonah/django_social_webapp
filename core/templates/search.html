{%extends 'base.html'%}
{%load static%}
{%block content%}
<div class="dark:bg-black">
    <div class="text-2xl text-gray-100 md:hidden flex justify-center mx-auto pb-4 sticky top-0 bg-white dark:bg-black z-10">
        {%include 'partials/navbar2.html'%}
    </div>
    <div class="h-screen flex justify-center max-w-6xl container mx-auto bg-white dark:bg-black">
        <div class="text-2xl hidden md:block">
            {%include 'partials/navbar.html'%}
        </div>
        <div class="border-l-2 border-gray-200 dark:border-gray-600 w-full">
            <div class="flex items-center space-x-10 px-2 pt-6 justify-center">
                <form action="" method="POST">{%csrf_token%}
                    <input id="searcharea" type="text" name="search" placeholder="Search..." class="p-2 pl-4 text-gray-700 rounded-full w-96 border-2 border-gray-200">
                    <input disabled id="searchbutton" type="submit" value="Search" class="ml-8 p-2 bg-gray-200 rounded-full text-black cursor-pointer shadow-white shadow-sm">   
                </form>
            </div>
            
            <div class="border-t-2 border-gray-200 dark:border-gray-600 mt-6">
                <p class="text-gray-900 dark:text-gray-200 px-32 pt-6 font-semibold">Suggested For You</p>
                {%for other_profile in other_profiles%}
                <div class="flex justify-center">
                    <div class="flex justify-between bg-gray-100 dark:bg-gray-900 m-7 p-4 rounded-md w-3/5">
                        <a href="{% url 'core:profile' username=other_profile.user.username %}">
                            <div>
                                <p class="pl-2 pb-2 font-semibold text-gray-900 dark:text-gray-200">@{{other_profile.user.username}}</p>
                                <img src="{{other_profile.profile_pics.url}}" class="profile_img w-24 h-24 border-2 border-gray-300 dark:border-0" alt="">
                            </div>
                        </a>
                        <span>
                            <a href="{% url 'core:profile' username=other_profile.user.username %}" name="username">
                                <p class="bg-blue-600 text-white p-3 rounded-full cursor-pointer hover:bg-blue-500 duration-500">
                                    View Profile
                                </p>
                            </a>      
                        </span>
                    </div>
                </div>     
                {%endfor%}
            </div>
        </div>
    </div>
</div>
{%include 'partials/footnote.html'%}
<script type="text/javascript">
    //event listener to enable and disable the search button
    const searcharea = document.getElementById('searcharea')
    const searchbutton = document.getElementById('searchbutton')

    searcharea.addEventListener('keyup', (e)=>{
        const value = e.currentTarget.value;
        if(value==""){
            searchbutton.classList.replace("bg-blue-600", 'bg-gray-200')
            searchbutton.classList.replace("text-white", 'text-black')
            searchbutton.disabled = true
        }
        else{
            searchbutton.classList.replace('bg-gray-200', "bg-blue-600")
            searchbutton.classList.replace('text-black', "text-white")
            searchbutton.disabled = false
            
        }
    })

//toggle functionality for light/dark modes
const sunIcon = document.getElementById('sun')
const moonIcon = document.getElementById('moon')

const userTheme = localStorage.getItem('theme')
const systemTheme = window.matchMedia('(prefered-color-scheme: dark)').matches

const iconToggle = ()=>{
    sunIcon.classList.toggle('hidden')
    moonIcon.classList.toggle('hidden')
}

const themeCheck = ()=>{
    if(userTheme === 'dark' || (!userTheme && systemTheme)){
        document.documentElement.classList.add('dark')
        moonIcon.classList.add('hidden')
        return;
    }
    sunIcon.classList.add('hidden')
}

const themeSwitch = ()=> {
    if (document.documentElement.classList.contains('dark')){
        document.documentElement.classList.remove('dark')
        localStorage.setItem('theme', 'Light')
        iconToggle()
        return;
    }
    document.documentElement.classList.add('dark');
    localStorage.setItem('theme', 'dark')
    iconToggle()
}

sunIcon.addEventListener('click', ()=>{
    themeSwitch()
})

moonIcon.addEventListener('click', ()=>{
    themeSwitch()
})

themeCheck()
</script>
{%endblock%}